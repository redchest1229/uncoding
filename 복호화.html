<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>μ•”νΈ λ³µνΈν™” ν†µν•©κΈ°</title>
</head>
<body>

<h1>π” μ•”νΈ λ³µνΈν™” ν†µν•© ν”„λ΅κ·Έλ¨</h1>

<hr><br>

<!-- ========================================= -->
<!-- 1) κ³ μ • key μ…λ ¥ μ‹μ € μ•”νΈ λ³µνΈν™” -->
<!-- ========================================= -->
<h2>1) ν‚¤ κΈ°λ° μ‹μ € λ³µνΈν™”(κΉ€μμ§„)</h2>

<label>μ•”νΈν™”λ λ¬Έμμ—΄:</label><br>
<input type="text" id="coded" style="width:400px;"><br><br>

<label>κ° λ¬Έμμ— μ μ©λ key (κ³µλ°±μΌλ΅ κµ¬λ¶„):</label><br>
<input type="text" id="key" style="width:400px;" placeholder="μ: 3 1 2 4 0"><br><br>

<button onclick="decodeKey()">λ³µνΈν™”ν•κΈ°</button>

<h3>κ²°κ³Ό:</h3>
<div id="result_key" style="font-size:20px; font-weight:bold;"></div>



<br><hr><br>

<!-- ========================================= -->
<!-- 2) κ°€λ³€ μ‹μ € μ•”νΈ λ³µνΈν™” (move(i) κΈ°λ°) -->
<!-- ========================================= -->
<h2>2) κ°€λ³€ μ‹μ € λ³µνΈν™”(λ°±μΉμ°¬)</h2>

<label>μ•”νΈλ¬Έ:</label><br>
<input type="text" id="cipher" style="width:400px;"><br><br>

<button onclick="testDecrypt()">λ³µνΈν™”ν•κΈ°</button>

<h3>κ²°κ³Ό:</h3>
<div id="result_var" style="font-size:20px; font-weight:bold;"></div>


<script>
/* -------------------------------------------------
   1) ν‚¤ κΈ°λ° μ‹μ € λ³µνΈν™” (μ²μμ— λ§λ“¤μ–΄μ¤€ λ²„μ „)
----------------------------------------------------*/
function decodeKey() {
    const coded = document.getElementById("coded").value;
    const coded_list = coded.split("");

    const key = document.getElementById("key").value.split(" ").map(Number);

    let decoded = [];

    for (let i = 0; i < coded_list.length; i++) {
        let j = coded_list[i];
        let shift = key[i];

        if (/[A-Z]/.test(j)) {
            let origin = 'A'.charCodeAt(0);
            let k = String.fromCharCode(((j.charCodeAt(0) - origin - shift) % 26 + 26) % 26 + origin);
            decoded.push(k);
        }
        else if (/[a-z]/.test(j)) {
            let origin = 'a'.charCodeAt(0);
            let k = String.fromCharCode(((j.charCodeAt(0) - origin - shift) % 26 + 26) % 26 + origin);
            decoded.push(k);
        }
        else if (/[0-9]/.test(j)) {
            let k = ((parseInt(j) - shift) % 10 + 10) % 10;
            decoded.push(k.toString());
        }
        else {
            decoded.push(j);
        }
    }

    document.getElementById("result_key").innerText = decoded.join("");
}



/* -------------------------------------------------
   2) κ°€λ³€ μ‹μ € μ•”νΈ λ³µνΈν™” (move(i) κΈ°λ°)
   (λ‘ λ²μ§Έλ΅ μ”μ²­ν–λ λ²„μ „)
----------------------------------------------------*/
function move(i) {
    return (Math.floor(Math.abs(Math.sin(i) * 10)) + i * i) % 26;
}

function decrypt(ciphertext) {
    let original = "";

    for (let i = 0; i < ciphertext.length; i++) {
        let ch = ciphertext[i];

        if (/[A-Za-z]/.test(ch)) {
            let base = ch >= 'A' && ch <= 'Z' ? 'A'.charCodeAt(0) : 'a'.charCodeAt(0);
            let shift = move(i);
            let code = ((ch.charCodeAt(0) - base - shift) % 26 + 26) % 26 + base;
            original += String.fromCharCode(code);
        } else {
            original += ch;
        }
    }

    return original;
}

function testDecrypt() {
    const cipher = document.getElementById("cipher").value;
    const result = decrypt(cipher);

    document.getElementById("result_var").innerText = result;
}
</script>

</body>
</html>
